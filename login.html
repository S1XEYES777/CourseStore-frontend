<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>Course Store ‚Äî –í—Ö–æ–¥</title>

    <link rel="stylesheet" href="assets/style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>

<!-- ================= HEADER ================= -->
<header class="site-header">
    <div class="container navbar">
        <div class="logo">
            <span>CS</span> Course Store
        </div>

        <nav class="nav-links">
            <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥</a>
            <a href="login.html" class="active">–í—Ö–æ–¥</a>
        </nav>
    </div>
</header>


<!-- ================= AUTH PAGE ================= -->
<main class="auth-page">

    <div class="auth-card">
        <div class="auth-header">
            <h1 class="auth-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å üëã</h1>
            <p class="auth-subtitle">–í–æ–π–¥–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫—É—Ä—Å–∞–º.</p>
        </div>

        <!-- Tabs -->
        <div class="auth-tabs">
            <button id="tab-login" class="auth-tab active">–í—Ö–æ–¥</button>
            <button id="tab-register" class="auth-tab">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        </div>

        <!-- ========== LOGIN FORM ========== -->
        <div id="login-form">
            <div class="form-group">
                <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                <input id="loginPhone" class="form-input" type="text" placeholder="+7..." />
            </div>

            <div class="form-group">
                <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
                <input id="loginPass" class="form-input" type="password" placeholder="–ü–∞—Ä–æ–ª—å" />
            </div>

            <button class="btn btn-primary btn-block" onclick="login()">–í–æ–π—Ç–∏</button>

            <p class="auth-footnote">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ü–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ ¬´–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è¬ª</p>
        </div>

        <!-- ========== REGISTER FORM ========== -->
        <div id="register-form" style="display:none;">
            <div class="form-group">
                <label class="form-label">–ò–º—è</label>
                <input id="regName" class="form-input" type="text" placeholder="–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?" />
            </div>

            <div class="form-group">
                <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                <input id="regPhone" class="form-input" type="text" placeholder="+7..." />
            </div>

            <div class="form-group">
                <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
                <input id="regPass" class="form-input" type="password" placeholder="–ü—Ä–∏–¥—É–º–∞–π –ø–∞—Ä–æ–ª—å" />
            </div>

            <button class="btn btn-primary btn-block" onclick="registerUser()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>

            <p class="auth-footnote">–ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥—ë—à—å –≤ –∫–∞—Ç–∞–ª–æ–≥.</p>
        </div>

    </div>

</main>


<!-- ================= FOOTER ================= -->
<footer class="site-footer">
    ¬© 2025 Course Store ‚Äî –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞.
</footer>


<script src="assets/script.js"></script>

<script>
/* ==========================
   –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ –í–ö–õ–ê–î–û–ö
========================== */
const tabLogin = document.getElementById("tab-login");
const tabRegister = document.getElementById("tab-register");
const loginForm = document.getElementById("login-form");
const registerForm = document.getElementById("register-form");

tabLogin.onclick = () => {
    tabLogin.classList.add("active");
    tabRegister.classList.remove("active");
    loginForm.style.display = "";
    registerForm.style.display = "none";
};

tabRegister.onclick = () => {
    tabRegister.classList.add("active");
    tabLogin.classList.remove("active");
    loginForm.style.display = "none";
    registerForm.style.display = "";
};


/* ==========================
   –ï–°–õ–ò –£–ñ–ï –ó–ê–õ–û–ì–ò–ù–ï–ù ‚Äî –ü–ï–†–ï–•–û–î
========================== */
if (getUser()) {
    window.location.href = "catalog.html";
}


/* ==========================
       –í–•–û–î
========================== */
async function login() {
    const phone = loginPhone.value.trim();
    const pass = loginPass.value.trim();

    if (!phone || !pass) {
        showMessage("–ó–∞–ø–æ–ª–Ω–∏ —Ç–µ–ª–µ—Ñ–æ–Ω –∏ –ø–∞—Ä–æ–ª—å.", "warning");
        return;
    }

    try {
        const data = await apiPost("/api/login", { phone, password: pass });

        if (data.user) saveUser(data.user);

        showMessage("–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥!", "success");
        window.location.href = "catalog.html";

    } catch (err) {
        showMessage(err.message || "–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", "error");
    }
}


/* ==========================
       –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø + –í–•–û–î
========================== */
async function registerUser() {
    const name = regName.value.trim();
    const phone = regPhone.value.trim();
    const pass = regPass.value.trim();

    if (!name || !phone || !pass) {
        showMessage("–ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è.", "warning");
        return;
    }

    try {
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
        await apiPost("/api/register", { name, phone, password: pass });

        showMessage("–£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è! –í—Ö–æ–¥–∏–º...", "success");

        // –ê–≤—Ç–æ-–≤—Ö–æ–¥
        const data = await apiPost("/api/login", { phone, password: pass });

        if (data.user) saveUser(data.user);

        window.location.href = "catalog.html";

    } catch (err) {
        showMessage(err.message || "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å", "error");
    }
}
</script>

</body>
</html>
